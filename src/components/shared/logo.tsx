"use client";

import { useState, useEffect } from "react";
import Link from "next/link";
import clsx from "clsx";
import { useTheme } from "next-themes";

type Size = "small" | "medium" | "large";

export function Logo({
	size = "medium",
	className,
}: {
	size?: Size;
	className?: string;
}) {
	// 1. Aggiungi uno stato per tracciare se il componente Ã¨ montato sul client
	const [isMounted, setIsMounted] = useState(false);
	const { theme, resolvedTheme } = useTheme();

	// 2. Usa useEffect per cambiare lo stato solo dopo il primo render sul client
	useEffect(() => {
		setIsMounted(true);
	}, []);

	// 3. Se non siamo ancora montati, non renderizzare nulla per evitare il mismatch
	if (!isMounted) {
		return null;
	}

	// Dimensioni
	const sizeClasses: Record<Size, string> = {
		small: "w-24 h-auto",
		medium: "w-40 h-auto",
		large: "w-56 h-auto",
	};

	// Palette per light/dark
	const colors = {
		light: {
			pink: "#E9327C",
			blue: "#1DACE3",
			navy: "#001A49",
			text: "#000000",
		},
		dark: {
			pink: "#FF5C93",
			blue: "#3BC6FF",
			navy: "#FFFFFF",
			text: "#FFFFFF",
		},
	};

	// Usa resolvedTheme per gestire anche "system"
	const currentTheme = theme === "system" ? resolvedTheme : theme;
	const palette = currentTheme === "dark" ? colors.dark : colors.light;

	return (
		<Link href="/" aria-label="Home">
			<svg
				data-logo="logo"
				xmlns="http://www.w3.org/2000/svg"
				viewBox="0 0 182 42"
				className={clsx(sizeClasses[size], className)}>
				<title>Logo</title>
				{/* Il resto del tuo SVG non cambia */}
				<g id="logogram" transform="translate(0, 1) rotate(0)">
					<path
						d="M28.7089 33.1053L1.9434 14.6424C-0.768963 12.7715 0.15306 8.87601 3.53531 7.95996L31.9823 0.239132C32.5849 0.0216955 33.2306 -0.0488885 33.866 0.0332432C34.5013 0.115375 35.1079 0.34785 35.6355 0.711378C36.1629 1.07491 36.5961 1.559 36.899 2.12348C37.2018 2.68795 37.3658 3.31654 37.3771 3.95706L35.6912 30.1393C35.4913 33.247 31.4213 34.9762 28.7089 33.1053Z"
						fill={palette.pink}
					/>
					<path
						d="M20.2197 37.6632L4.45132 6.82618C4.09087 6.12072 3.93226 5.32941 3.99297 4.53953C4.05367 3.74965 4.33135 2.99187 4.79536 2.34978C5.25939 1.70769 5.89172 1.20622 6.62264 0.900668C7.35356 0.595117 8.15466 0.497365 8.93761 0.618198L38.1604 5.12834C38.8331 5.23219 39.4717 5.49425 40.0236 5.89298C40.5753 6.29172 41.0245 6.81572 41.3344 7.42191C41.6441 8.0281 41.8057 8.69917 41.8055 9.37994C41.8054 10.0607 41.6437 10.7317 41.3338 11.3378L27.8719 37.6647C27.5104 38.3681 26.962 38.9583 26.2869 39.3703C25.6118 39.7823 24.8363 40.0002 24.0454 40C23.2545 39.9999 22.479 39.7817 21.804 39.3695C21.1291 38.9571 20.5809 38.3668 20.2197 37.6632Z"
						fill={palette.blue}
					/>
					<path
						d="M37.3055 4.9955L22.7382 2.74713L4.85269 7.60342L11.9917 21.5695L28.7089 33.1053C29.0777 33.357 29.4834 33.5497 29.9114 33.6767L36.2612 21.2592L37.3055 4.9955Z"
						fill={palette.navy}
					/>
				</g>
				<g id="logotype" transform="translate(48, 1)">
					<path
						fill={palette.text}
						d="M19.65 33.45L19.65 33.45Q16.92 33.45 14.59 32.48Q12.27 31.50 10.53 29.75Q8.80 27.99 7.84 25.70Q6.88 23.41 6.88 20.78L6.88 20.78Q6.88 18.16 7.84 15.85Q8.80 13.54 10.53 11.79Q12.27 10.04 14.59 9.04Q16.92 8.04 19.65 8.04L19.65 8.04Q22.77 8.04 24.95 9.04Q27.14 10.04 28.65 11.89L28.65 11.89L25.15 14.90Q24.17 13.82 22.77 13.21Q21.37 12.59 19.65 12.59L19.65 12.59Q17.30 12.59 15.57 13.71Q13.84 14.83 12.89 16.69Q11.95 18.54 11.95 20.78L11.95 20.78Q11.95 23.02 12.89 24.88Q13.84 26.73 15.57 27.86Q17.30 28.98 19.65 28.98L19.65 28.98Q22.56 28.98 24.34 27.59Q26.13 26.21 26.55 23.34L26.55 23.34L18.50 23.41L18.50 19L31.27 19Q31.34 19.56 31.39 20.35Q31.45 21.13 31.45 21.73L31.45 21.73Q31.45 25.13 30.03 27.77Q28.61 30.41 25.97 31.93Q23.33 33.45 19.65 33.45ZM42.37 33.45L42.37 33.45Q39.57 33.45 37.36 32.16Q35.16 30.86 33.91 28.71Q32.67 26.56 32.67 23.93L32.67 23.93Q32.67 21.31 33.91 19.14Q35.16 16.97 37.36 15.67Q39.57 14.38 42.37 14.38L42.37 14.38Q45.20 14.38 47.39 15.67Q49.58 16.97 50.82 19.14Q52.06 21.31 52.06 23.93L52.06 23.93Q52.06 26.56 50.82 28.71Q49.58 30.86 47.39 32.16Q45.20 33.45 42.37 33.45ZM42.37 29.15L42.37 29.15Q43.87 29.15 44.99 28.43Q46.11 27.71 46.72 26.52Q47.34 25.34 47.34 23.93L47.34 23.93Q47.34 22.50 46.72 21.31Q46.11 20.12 44.99 19.40Q43.87 18.68 42.37 18.68L42.37 18.68Q40.86 18.68 39.74 19.40Q38.62 20.12 38.01 21.31Q37.40 22.50 37.40 23.93L37.40 23.93Q37.40 25.34 38.01 26.52Q38.62 27.71 39.74 28.43Q40.86 29.15 42.37 29.15ZM61.79 33.45L61.79 33.45Q58.89 33.45 56.45 32.21Q54.02 30.97 52.41 28.17L52.41 28.17L56.65 25.48Q57.59 27.36 59.03 28.22Q60.46 29.08 62.07 29.08L62.07 29.08Q63.79 29.08 64.77 28.31Q65.75 27.54 65.75 26.28L65.75 26.28Q65.75 25.05 64.98 24.32Q64.20 23.59 62.93 23.13Q61.65 22.67 60.15 22.29L60.15 22.29Q57.31 21.55 55.63 19.86Q53.95 18.16 53.95 15.39L53.95 15.39Q53.95 13.19 55.04 11.54Q56.12 9.90 58.06 8.99Q60.01 8.08 62.59 8.08L62.59 8.08Q65.47 8.08 67.39 9.27Q69.31 10.46 70.68 12.63L70.68 12.63L66.48 15.22Q65.61 13.78 64.66 13.12Q63.72 12.45 62.35 12.45L62.35 12.45Q60.88 12.45 59.92 13.19Q58.96 13.92 58.96 15.15L58.96 15.15Q58.96 16.51 60.09 17.13Q61.23 17.74 62.84 18.23L62.84 18.23Q63.93 18.58 65.27 19.05Q66.62 19.52 67.88 20.35Q69.14 21.17 69.95 22.53Q70.75 23.90 70.75 26L70.75 26Q70.75 28.20 69.67 29.88Q68.58 31.57 66.59 32.51Q64.59 33.45 61.79 33.45ZM77.65 33L72.92 33L72.92 7.45L77.65 7.45L77.65 17.32Q79.12 14.38 83.14 14.38L83.14 14.38Q85.10 14.38 86.68 15.29Q88.25 16.20 89.16 17.88Q90.07 19.56 90.07 21.87L90.07 21.87L90.07 33L85.35 33L85.35 23.02Q85.35 20.64 84.26 19.58Q83.18 18.51 81.43 18.51L81.43 18.51Q79.92 18.51 78.78 19.58Q77.65 20.64 77.65 23.02L77.65 23.02L77.65 33ZM101.69 33.45L101.69 33.45Q98.89 33.45 96.69 32.16Q94.48 30.86 93.24 28.71Q92.00 26.56 92.00 23.93L92.00 23.93Q92.00 21.31 93.24 19.14Q94.48 16.97 96.69 15.67Q98.89 14.38 101.69 14.38L101.69 14.38Q104.53 14.38 106.71 15.67Q108.90 16.97 110.14 19.14Q111.39 21.31 111.39 23.93L111.39 23.93Q111.39 26.56 110.14 28.71Q108.90 30.86 106.71 32.16Q104.53 33.45 101.69 33.45ZM101.69 29.15L101.69 29.15Q103.20 29.15 104.32 28.43Q105.44 27.71 106.05 26.52Q106.66 25.34 106.66 23.93L106.66 23.93Q106.66 22.50 106.05 21.31Q105.44 20.12 104.32 19.40Q103.20 18.68 101.69 18.68L101.69 18.68Q100.19 18.68 99.07 19.40Q97.95 20.12 97.33 21.31Q96.72 22.50 96.72 23.93L96.72 23.93Q96.72 25.34 97.33 26.52Q97.95 27.71 99.07 28.43Q100.19 29.15 101.69 29.15ZM118.21 40L113.49 40L113.49 14.80L118.14 14.80L118.14 17.74Q118.88 16.23 120.22 15.32Q121.57 14.41 123.95 14.41L123.95 14.41Q125.84 14.41 127.47 15.17Q129.10 15.92 130.32 17.23Q131.55 18.54 132.25 20.28Q132.95 22.01 132.95 23.97L132.95 23.97Q132.95 26.59 131.74 28.75Q130.53 30.90 128.50 32.18Q126.47 33.45 123.95 33.45L123.95 33.45Q121.61 33.45 120.28 32.60Q118.95 31.74 118.21 30.30L118.21 30.30L118.21 40ZM123.18 29.18L123.18 29.18Q124.69 29.18 125.82 28.45Q126.96 27.71 127.59 26.51Q128.22 25.30 128.22 23.93L128.22 23.93Q128.22 22.50 127.59 21.31Q126.96 20.12 125.82 19.40Q124.69 18.68 123.18 18.68L123.18 18.68Q121.64 18.68 120.49 19.42Q119.33 20.16 118.70 21.34Q118.07 22.53 118.07 23.97L118.07 23.97Q118.07 25.37 118.70 26.56Q119.33 27.75 120.49 28.47Q121.64 29.18 123.18 29.18Z"
					/>
				</g>
			</svg>
		</Link>
	);
}
